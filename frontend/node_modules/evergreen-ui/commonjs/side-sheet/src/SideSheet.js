"use strict";

var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = void 0;

var _extends2 = _interopRequireDefault(require("@babel/runtime/helpers/extends"));

var _classCallCheck2 = _interopRequireDefault(require("@babel/runtime/helpers/classCallCheck"));

var _createClass2 = _interopRequireDefault(require("@babel/runtime/helpers/createClass"));

var _possibleConstructorReturn2 = _interopRequireDefault(require("@babel/runtime/helpers/possibleConstructorReturn"));

var _getPrototypeOf2 = _interopRequireDefault(require("@babel/runtime/helpers/getPrototypeOf"));

var _inherits2 = _interopRequireDefault(require("@babel/runtime/helpers/inherits"));

var _objectSpread2 = _interopRequireDefault(require("@babel/runtime/helpers/objectSpread"));

var _defineProperty2 = _interopRequireDefault(require("@babel/runtime/helpers/defineProperty"));

var _react = _interopRequireDefault(require("react"));

var _propTypes = _interopRequireDefault(require("prop-types"));

var _uiBox = require("ui-box");

var _layers = require("../../layers");

var _overlay = require("../../overlay");

var _constants = require("../../constants");

var _SheetClose = _interopRequireDefault(require("./SheetClose"));

var _paneProps, _subpaneProps, _animationStyles;

var paneProps = (_paneProps = {}, (0, _defineProperty2.default)(_paneProps, _constants.Position.LEFT, {
  height: '100vh',
  maxWidth: '100vw',
  position: 'absolute',
  left: 0,
  right: 'auto'
}), (0, _defineProperty2.default)(_paneProps, _constants.Position.RIGHT, {
  height: '100vh',
  maxWidth: '100vw',
  position: 'absolute',
  right: 0,
  left: 'auto'
}), (0, _defineProperty2.default)(_paneProps, _constants.Position.TOP, {
  width: '100vw',
  position: 'absolute',
  maxHeight: '100vh',
  top: 0,
  bottom: 'auto'
}), (0, _defineProperty2.default)(_paneProps, _constants.Position.BOTTOM, {
  width: '100vw',
  maxHeight: '100vh',
  position: 'absolute',
  bottom: 0,
  top: 'auto'
}), _paneProps);
var subpaneProps = (_subpaneProps = {}, (0, _defineProperty2.default)(_subpaneProps, _constants.Position.LEFT, {
  height: '100vh'
}), (0, _defineProperty2.default)(_subpaneProps, _constants.Position.RIGHT, {
  height: '100vh'
}), (0, _defineProperty2.default)(_subpaneProps, _constants.Position.TOP, {
  width: '100vw'
}), (0, _defineProperty2.default)(_subpaneProps, _constants.Position.BOTTOM, {
  width: '100vw'
}), _subpaneProps);
var animationEasing = {
  deceleration: "cubic-bezier(0.0, 0.0, 0.2, 1)",
  acceleration: "cubic-bezier(0.4, 0.0, 1, 1)"
};
var ANIMATION_DURATION = 240;

var withAnimations = function withAnimations(animateIn, animateOut) {
  return {
    '&[data-state="entering"], &[data-state="entered"]': {
      animation: "".concat(animateIn, " ").concat(ANIMATION_DURATION, "ms ").concat(animationEasing.deceleration, " both")
    },
    '&[data-state="exiting"]': {
      animation: "".concat(animateOut, " ").concat(ANIMATION_DURATION, "ms ").concat(animationEasing.acceleration, " both")
    }
  };
};

var animationStyles = (_animationStyles = {}, (0, _defineProperty2.default)(_animationStyles, _constants.Position.LEFT, (0, _objectSpread2.default)({
  transform: "translateX(-100%)"
}, withAnimations(_uiBox.css.keyframes('anchoredLeftSlideInAnimation', {
  from: {
    transform: "translateX(-100%)"
  },
  to: {
    transform: "translateX(0)"
  }
}), _uiBox.css.keyframes('anchoredLeftSlideOutAnimation', {
  from: {
    transform: "translateX(0)"
  },
  to: {
    transform: "translateX(-100%)"
  }
})))), (0, _defineProperty2.default)(_animationStyles, _constants.Position.RIGHT, (0, _objectSpread2.default)({
  transform: "translateX(100%)"
}, withAnimations(_uiBox.css.keyframes('anchoredRightSlideInAnimation', {
  from: {
    transform: "translateX(100%)"
  },
  to: {
    transform: "translateX(0)"
  }
}), _uiBox.css.keyframes('anchoredRightSlideOutAnimation', {
  from: {
    transform: "translateX(0)"
  },
  to: {
    transform: "translateX(100%)"
  }
})))), (0, _defineProperty2.default)(_animationStyles, _constants.Position.TOP, (0, _objectSpread2.default)({
  transform: "translateY(-100%)"
}, withAnimations(_uiBox.css.keyframes('anchoredTopSlideInAnimation', {
  from: {
    transform: "translateY(-100%)"
  },
  to: {
    transform: "translateY(0)"
  }
}), _uiBox.css.keyframes('anchoredTopSlideOutAnimation', {
  from: {
    transform: "translateY(0)"
  },
  to: {
    transform: "translateY(-100%)"
  }
})))), (0, _defineProperty2.default)(_animationStyles, _constants.Position.BOTTOM, (0, _objectSpread2.default)({
  transform: "translateY(100%)"
}, withAnimations(_uiBox.css.keyframes('anchoredBottomSlideInAnimation', {
  from: {
    transform: "translateY(100%)"
  },
  to: {
    transform: "translateY(0)"
  }
}), _uiBox.css.keyframes('anchoredBottomSlideOutAnimation', {
  from: {
    transform: "translateY(0)"
  },
  to: {
    transform: "translateY(100%)"
  }
})))), _animationStyles);

var SideSheet =
/*#__PURE__*/
function (_React$Component) {
  (0, _inherits2.default)(SideSheet, _React$Component);

  function SideSheet() {
    (0, _classCallCheck2.default)(this, SideSheet);
    return (0, _possibleConstructorReturn2.default)(this, (0, _getPrototypeOf2.default)(SideSheet).apply(this, arguments));
  }

  (0, _createClass2.default)(SideSheet, [{
    key: "render",
    value: function render() {
      var _this$props = this.props,
          width = _this$props.width,
          isShown = _this$props.isShown,
          children = _this$props.children,
          containerProps = _this$props.containerProps,
          onOpenComplete = _this$props.onOpenComplete,
          onCloseComplete = _this$props.onCloseComplete,
          shouldCloseOnOverlayClick = _this$props.shouldCloseOnOverlayClick,
          shouldCloseOnEscapePress = _this$props.shouldCloseOnEscapePress,
          position = _this$props.position;
      return _react.default.createElement(_overlay.Overlay, {
        isShown: isShown,
        shouldCloseOnClick: shouldCloseOnOverlayClick,
        shouldCloseOnEscapePress: shouldCloseOnEscapePress,
        onExited: onCloseComplete,
        onEntered: onOpenComplete
      }, function (_ref) {
        var state = _ref.state,
            close = _ref.close;
        return _react.default.createElement(_layers.Pane, (0, _extends2.default)({
          width: width
        }, paneProps[position], {
          css: animationStyles[position],
          "data-state": state
        }), _react.default.createElement(_SheetClose.default, {
          position: position,
          "data-state": state,
          isClosing: false,
          onClick: close
        }), _react.default.createElement(_layers.Pane, (0, _extends2.default)({
          elevation: 4,
          backgroundColor: "white",
          overflowY: "auto",
          maxHeight: "100vh",
          "data-state": state,
          width: width
        }, subpaneProps[position], containerProps), typeof children === 'function' ? children({
          close: close
        }) : children));
      });
    }
  }]);
  return SideSheet;
}(_react.default.Component);

SideSheet.displayName = "SideSheet";
(0, _defineProperty2.default)(SideSheet, "propTypes", {
  /**
   * Children can be a string, node or a function accepting `({ close })`.
   */
  children: _propTypes.default.oneOfType([_propTypes.default.node, _propTypes.default.func]).isRequired,

  /**
   * When true, the Side Sheet is shown.
   */
  isShown: _propTypes.default.bool,

  /**
   * Function that will be called when the exit transition is complete.
   */
  onCloseComplete: _propTypes.default.func,

  /**
   * Function that will be called when the enter transition is complete.
   */
  onOpenComplete: _propTypes.default.func,

  /**
   * Boolean indicating if clicking the overlay should close the overlay.
   */
  shouldCloseOnOverlayClick: _propTypes.default.bool,

  /**
   * Boolean indicating if pressing the esc key should close the overlay.
   */
  shouldCloseOnEscapePress: _propTypes.default.bool,

  /**
   * Width of the SideSheet.
   */
  width: _propTypes.default.oneOfType([_propTypes.default.string, _propTypes.default.number]).isRequired,

  /**
   * Properties to pass through the SideSheet container Pane.
   */
  containerProps: _propTypes.default.object,

  /**
   * Positions the sheet to the top, left, right, or bottom of the screen.
   */
  position: _propTypes.default.oneOf([_constants.Position.TOP, _constants.Position.BOTTOM, _constants.Position.LEFT, _constants.Position.RIGHT]).isRequired
});
(0, _defineProperty2.default)(SideSheet, "defaultProps", {
  width: 620,
  onCloseComplete: function onCloseComplete() {},
  onOpenComplete: function onOpenComplete() {},
  shouldCloseOnOverlayClick: true,
  shouldCloseOnEscapePress: true,
  position: _constants.Position.RIGHT
});
var _default = SideSheet;
exports.default = _default;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uLy4uL3NyYy9zaWRlLXNoZWV0L3NyYy9TaWRlU2hlZXQuanMiXSwibmFtZXMiOlsicGFuZVByb3BzIiwiUG9zaXRpb24iLCJMRUZUIiwiaGVpZ2h0IiwibWF4V2lkdGgiLCJwb3NpdGlvbiIsImxlZnQiLCJyaWdodCIsIlJJR0hUIiwiVE9QIiwid2lkdGgiLCJtYXhIZWlnaHQiLCJ0b3AiLCJib3R0b20iLCJCT1RUT00iLCJzdWJwYW5lUHJvcHMiLCJhbmltYXRpb25FYXNpbmciLCJkZWNlbGVyYXRpb24iLCJhY2NlbGVyYXRpb24iLCJBTklNQVRJT05fRFVSQVRJT04iLCJ3aXRoQW5pbWF0aW9ucyIsImFuaW1hdGVJbiIsImFuaW1hdGVPdXQiLCJhbmltYXRpb24iLCJhbmltYXRpb25TdHlsZXMiLCJ0cmFuc2Zvcm0iLCJjc3MiLCJrZXlmcmFtZXMiLCJmcm9tIiwidG8iLCJTaWRlU2hlZXQiLCJwcm9wcyIsImlzU2hvd24iLCJjaGlsZHJlbiIsImNvbnRhaW5lclByb3BzIiwib25PcGVuQ29tcGxldGUiLCJvbkNsb3NlQ29tcGxldGUiLCJzaG91bGRDbG9zZU9uT3ZlcmxheUNsaWNrIiwic2hvdWxkQ2xvc2VPbkVzY2FwZVByZXNzIiwic3RhdGUiLCJjbG9zZSIsIlJlYWN0IiwiQ29tcG9uZW50IiwiUHJvcFR5cGVzIiwib25lT2ZUeXBlIiwibm9kZSIsImZ1bmMiLCJpc1JlcXVpcmVkIiwiYm9vbCIsInN0cmluZyIsIm51bWJlciIsIm9iamVjdCIsIm9uZU9mIl0sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBQUE7O0FBQ0E7O0FBQ0E7O0FBQ0E7O0FBQ0E7O0FBQ0E7O0FBQ0E7Ozs7QUFFQSxJQUFNQSxTQUFTLCtEQUNaQyxvQkFBU0MsSUFERyxFQUNJO0FBQ2ZDLEVBQUFBLE1BQU0sRUFBRSxPQURPO0FBRWZDLEVBQUFBLFFBQVEsRUFBRSxPQUZLO0FBR2ZDLEVBQUFBLFFBQVEsRUFBRSxVQUhLO0FBSWZDLEVBQUFB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RSwyQkFBTSxDQUFFLENBRkw7QUFHcEJELEVBQUFBLGNBQWMsRUFBRSwwQkFBTSxDQUFFLENBSEo7QUFJcEJFLEVBQUFBLHlCQUF5QixFQUFFLElBSlA7QUFLcEJDLEVBQUFBLHdCQUF3QixFQUFFLElBTE47QUFNcEJqQyxFQUFBQSxRQUFRLEVBQUVKLG9CQUFTTztBQU5DLEM7ZUE4RFRzQixTIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IFJlYWN0IGZyb20gJ3JlYWN0J1xuaW1wb3J0IFByb3BUeXBlcyBmcm9tICdwcm9wLXR5cGVzJ1xuaW1wb3J0IHsgY3NzIH0gZnJvbSAndWktYm94J1xuaW1wb3J0IHsgUGFuZSB9IGZyb20gJy4uLy4uL2xheWVycydcbmltcG9ydCB7IE92ZXJsYXkgfSBmcm9tICcuLi8uLi9vdmVybGF5J1xuaW1wb3J0IHsgUG9zaXRpb24gfSBmcm9tICcuLi8uLi9jb25zdGFudHMnXG5pbXBvcnQgU2hlZXRDbG9zZSBmcm9tICcuL1NoZWV0Q2xvc2UnXG5cbmNvbnN0IHBhbmVQcm9wcyA9IHtcbiAgW1Bvc2l0aW9uLkxFRlRdOiB7XG4gICAgaGVpZ2h0OiAnMTAwdmgnLFxuICAgIG1heFdpZHRoOiAnMTAwdncnLFxuICAgIHBvc2l0aW9uOiAnYWJzb2x1dGUnLFxuICAgIGxlZnQ6IDAsXG4gICAgcmlnaHQ6ICdhdXRvJ1xuICB9LFxuICBbUG9zaXRpb24uUklHSFRdOiB7XG4gICAgaGVpZ2h0OiAnMTAwdmgnLFxuICAgIG1heFdpZHRoOiAnMTAwdncnLFxuICAgIHBvc2l0aW9uOiAnYWJzb2x1dGUnLFxuICAgIHJpZ2h0OiAwLFxuICAgIGxlZnQ6ICdhdXRvJ1xuICB9LFxuICBbUG9zaXRpb24uVE9QXToge1xuICAgIHdpZHRoOiAnMTAwdncnLFxuICAgIHBvc2l0aW9uOiAnYWJzb2x1dGUnLFxuICAgIG1heEhlaWdodDogJzEwMHZoJyxcbiAgICB0b3A6IDAsXG4gICAgYm90dG9tOiAnYXV0bydcbiAgfSxcbiAgW1Bvc2l0aW9uLkJPVFRPTV06IHtcbiAgICB3aWR0aDogJzEwMHZ3JyxcbiAgICBtYXhIZWlnaHQ6ICcxMDB2aCcsXG4gICAgcG9zaXRpb246ICdhYnNvbHV0ZScsXG4gICAgYm90dG9tOiAwLFxuICAgIHRvcDogJ2F1dG8nXG4gIH1cbn1cblxuY29uc3Qgc3VicGFuZVByb3BzID0ge1xuICBbUG9zaXRpb24uTEVGVF06IHtcbiAgICBoZWlnaHQ6ICcxMDB2aCdcbiAgfSxcbiAgW1Bvc2l0aW9uLlJJR0hUXToge1xuICAgIGhlaWdodDogJzEwMHZoJ1xuICB9LFxuICBbUG9zaXRpb24uVE9QXToge1xuICAgIHdpZHRoOiAnMTAwdncnXG4gIH0sXG4gIFtQb3NpdGlvbi5CT1RUT01dOiB7XG4gICAgd2lkdGg6ICcxMDB2dydcbiAgfVxufVxuXG5jb25zdCBhbmltYXRpb25FYXNpbmcgPSB7XG4gIGRlY2VsZXJhdGlvbjogYGN1YmljLWJlemllcigwLjAsIDAuMCwgMC4yLCAxKWAsXG4gIGFjY2VsZXJhdGlvbjogYGN1YmljLWJlemllcigwLjQsIDAuMCwgMSwgMSlgXG59XG5cbmNvbnN0IEFOSU1BVElPTl9EVVJBVElPTiA9IDI0MFxuXG5jb25zdCB3aXRoQW5pbWF0aW9ucyA9IChhbmltYXRlSW4sIGFuaW1hdGVPdXQpID0+IHtcbiAgcmV0dXJuIHtcbiAgICAnJltkYXRhLXN0YXRlPVwiZW50ZXJpbmdcIl0sICZbZGF0YS1zdGF0ZT1cImVudGVyZWRcIl0nOiB7XG4gICAgICBhbmltYXRpb246IGAke2FuaW1hdGVJbn0gJHtBTklNQVRJT05fRFVSQVRJT059bXMgJHtcbiAgICAgICAgYW5pbWF0aW9uRWFzaW5nLmRlY2VsZXJhdGlvblxuICAgICAgfSBib3RoYFxuICAgIH0sXG4gICAgJyZbZGF0YS1zdGF0ZT1cImV4aXRpbmdcIl0nOiB7XG4gICAgICBhbmltYXRpb246IGAke2FuaW1hdGVPdXR9ICR7QU5JTUFUSU9OX0RVUkFUSU9OfW1zICR7XG4gICAgICAgIGFuaW1hdGlvbkVhc2luZy5hY2NlbGVyYXRpb25cbiAgICAgIH0gYm90aGBcbiAgICB9XG4gIH1cbn1cblxuY29uc3QgYW5pbWF0aW9uU3R5bGVzID0ge1xuICBbUG9zaXRpb24uTEVGVF06IHtcbiAgICB0cmFuc2Zvcm06IGB0cmFuc2xhdGVYKC0xMDAlKWAsXG4gICAgLi4ud2l0aEFuaW1hdGlvbnMoXG4gICAgICBjc3Mua2V5ZnJhbWVzKCdhbmNob3JlZExlZnRTbGlkZUluQW5pbWF0aW9uJywge1xuICAgICAgICBmcm9tOiB7IHRyYW5zZm9ybTogYHRyYW5zbGF0ZVgoLTEwMCUpYCB9LFxuICAgICAgICB0bzogeyB0cmFuc2Zvcm06IGB0cmFuc2xhdGVYKDApYCB9XG4gICAgICB9KSxcbiAgICAgIGNzcy5rZXlmcmFtZXMoJ2FuY2hvcmVkTGVmdFNsaWRlT3V0QW5pbWF0aW9uJywge1xuICAgICAgICBmcm9tOiB7IHRyYW5zZm9ybTogYHRyYW5zbGF0ZVgoMClgIH0sXG4gICAgICAgIHRvOiB7IHRyYW5zZm9ybTogYHRyYW5zbGF0ZVgoLTEwMCUpYCB9XG4gICAgICB9KVxuICAgIClcbiAgfSxcbiAgW1Bvc2l0aW9uLlJJR0hUXToge1xuICAgIHRyYW5zZm9ybTogYHRyYW5zbGF0ZVgoMTAwJSlgLFxuICAgIC4uLndpdGhBbmltYXRpb25zKFxuICAgICAgY3NzLmtleWZyYW1lcygnYW5jaG9yZWRSaWdodFNsaWRlSW5BbmltYXRpb24nLCB7XG4gICAgICAgIGZyb206IHsgdHJhbnNmb3JtOiBgdHJhbnNsYXRlWCgxMDAlKWAgfSxcbiAgICAgICAgdG86IHsgdHJhbnNmb3JtOiBgdHJhbnNsYXRlWCgwKWAgfVxuICAgICAgfSksXG4gICAgICBjc3Mua2V5ZnJhbWVzKCdhbmNob3JlZFJpZ2h0U2xpZGVPdXRBbmltYXRpb24nLCB7XG4gICAgICAgIGZyb206IHsgdHJhbnNmb3JtOiBgdHJhbnNsYXRlWCgwKWAgfSxcbiAgICAgICAgdG86IHsgdHJhbnNmb3JtOiBgdHJhbnNsYXRlWCgxMDAlKWAgfVxuICAgICAgfSlcbiAgICApXG4gIH0sXG4gIFtQb3NpdGlvbi5UT1BdOiB7XG4gICAgdHJhbnNmb3JtOiBgdHJhbnNsYXRlWSgtMTAwJSlgLFxuICAgIC4uLndpdGhBbmltYXRpb25zKFxuICAgICAgY3NzLmtleWZyYW1lcygnYW5jaG9yZWRUb3BTbGlkZUluQW5pbWF0aW9uJywge1xuICAgICAgICBmcm9tOiB7IHRyYW5zZm9ybTogYHRyYW5zbGF0ZVkoLTEwMCUpYCB9LFxuICAgICAgICB0bzogeyB0cmFuc2Zvcm06IGB0cmFuc2xhdGVZKDApYCB9XG4gICAgICB9KSxcbiAgICAgIGNzcy5rZXlmcmFtZXMoJ2FuY2hvcmVkVG9wU2xpZGVPdXRBbmltYXRpb24nLCB7XG4gICAgICAgIGZyb206IHsgdHJhbnNmb3JtOiBgdHJhbnNsYXRlWSgwKWAgfSxcbiAgICAgICAgdG86IHsgdHJhbnNmb3JtOiBgdHJhbnNsYXRlWSgtMTAwJSlgIH1cbiAgICAgIH0pXG4gICAgKVxuICB9LFxuICBbUG9zaXRpb24uQk9UVE9NXToge1xuICAgIHRyYW5zZm9ybTogYHRyYW5zbGF0ZVkoMTAwJSlgLFxuICAgIC4uLndpdGhBbmltYXRpb25zKFxuICAgICAgY3NzLmtleWZyYW1lcygnYW5jaG9yZWRCb3R0b21TbGlkZUluQW5pbWF0aW9uJywge1xuICAgICAgICBmcm9tOiB7IHRyYW5zZm9ybTogYHRyYW5zbGF0ZVkoMTAwJSlgIH0sXG4gICAgICAgIHRvOiB7IHRyYW5zZm9ybTogYHRyYW5zbGF0ZVkoMClgIH1cbiAgICAgIH0pLFxuICAgICAgY3NzLmtleWZyYW1lcygnYW5jaG9yZWRCb3R0b21TbGlkZU91dEFuaW1hdGlvbicsIHtcbiAgICAgICAgZnJvbTogeyB0cmFuc2Zvcm06IGB0cmFuc2xhdGVZKDApYCB9LFxuICAgICAgICB0bzogeyB0cmFuc2Zvcm06IGB0cmFuc2xhdGVZKDEwMCUpYCB9XG4gICAgICB9KVxuICAgIClcbiAgfVxufVxuXG5jbGFzcyBTaWRlU2hlZXQgZXh0ZW5kcyBSZWFjdC5Db21wb25lbnQge1xuICBzdGF0aWMgcHJvcFR5cGVzID0ge1xuICAgIC8qKlxuICAgICAqIENoaWxkcmVuIGNhbiBiZSBhIHN0cmluZywgbm9kZSBvciBhIGZ1bmN0aW9uIGFjY2VwdGluZyBgKHsgY2xvc2UgfSlgLlxuICAgICAqL1xuICAgIGNoaWxkcmVuOiBQcm9wVHlwZXMub25lT2ZUeXBlKFtQcm9wVHlwZXMubm9kZSwgUHJvcFR5cGVzLmZ1bmNdKS5pc1JlcXVpcmVkLFxuXG4gICAgLyoqXG4gICAgICogV2hlbiB0cnVlLCB0aGUgU2lkZSBTaGVldCBpcyBzaG93bi5cbiAgICAgKi9cbiAgICBpc1Nob3duOiBQcm9wVHlwZXMuYm9vbCxcblxuICAgIC8qKlxuICAgICAqIEZ1bmN0aW9uIHRoYXQgd2lsbCBiZSBjYWxsZWQgd2hlbiB0aGUgZXhpdCB0cmFuc2l0aW9uIGlzIGNvbXBsZXRlLlxuICAgICAqL1xuICAgIG9uQ2xvc2VDb21wbGV0ZTogUHJvcFR5cGVzLmZ1bmMsXG5cbiAgICAvKipcbiAgICAgKiBGdW5jdGlvbiB0aGF0IHdpbGwgYmUgY2FsbGVkIHdoZW4gdGhlIGVudGVyIHRyYW5zaXRpb24gaXMgY29tcGxldGUuXG4gICAgICovXG4gICAgb25PcGVuQ29tcGxldGU6IFByb3BUeXBlcy5mdW5jLFxuXG4gICAgLyoqXG4gICAgICogQm9vbGVhbiBpbmRpY2F0aW5nIGlmIGNsaWNraW5nIHRoZSBvdmVybGF5IHNob3VsZCBjbG9zZSB0aGUgb3ZlcmxheS5cbiAgICAgKi9cbiAgICBzaG91bGRDbG9zZU9uT3ZlcmxheUNsaWNrOiBQcm9wVHlwZXMuYm9vbCxcblxuICAgIC8qKlxuICAgICAqIEJvb2xlYW4gaW5kaWNhdGluZyBpZiBwcmVzc2luZyB0aGUgZXNjIGtleSBzaG91bGQgY2xvc2UgdGhlIG92ZXJsYXkuXG4gICAgICovXG4gICAgc2hvdWxkQ2xvc2VPbkVzY2FwZVByZXNzOiBQcm9wVHlwZXMuYm9vbCxcblxuICAgIC8qKlxuICAgICAqIFdpZHRoIG9mIHRoZSBTaWRlU2hlZXQuXG4gICAgICovXG4gICAgd2lkdGg6IFByb3BUeXBlcy5vbmVPZlR5cGUoW1Byb3BUeXBlcy5zdHJpbmcsIFByb3BUeXBlcy5udW1iZXJdKS5pc1JlcXVpcmVkLFxuXG4gICAgLyoqXG4gICAgICogUHJvcGVydGllcyB0byBwYXNzIHRocm91Z2ggdGhlIFNpZGVTaGVldCBjb250YWluZXIgUGFuZS5cbiAgICAgKi9cbiAgICBjb250YWluZXJQcm9wczogUHJvcFR5cGVzLm9iamVjdCxcblxuICAgIC8qKlxuICAgICAqIFBvc2l0aW9ucyB0aGUgc2hlZXQgdG8gdGhlIHRvcCwgbGVmdCwgcmlnaHQsIG9yIGJvdHRvbSBvZiB0aGUgc2NyZWVuLlxuICAgICAqL1xuICAgIHBvc2l0aW9uOiBQcm9wVHlwZXMub25lT2YoW1xuICAgICAgUG9zaXRpb24uVE9QLFxuICAgICAgUG9zaXRpb24uQk9UVE9NLFxuICAgICAgUG9zaXRpb24uTEVGVCxcbiAgICAgIFBvc2l0aW9uLlJJR0hUXG4gICAgXSkuaXNSZXF1aXJlZFxuICB9XG5cbiAgc3RhdGljIGRlZmF1bHRQcm9wcyA9IHtcbiAgICB3aWR0aDogNjIwLFxuICAgIG9uQ2xvc2VDb21wbGV0ZTogKCkgPT4ge30sXG4gICAgb25PcGVuQ29tcGxldGU6ICgpID0+IHt9LFxuICAgIHNob3VsZENsb3NlT25PdmVybGF5Q2xpY2s6IHRydWUsXG4gICAgc2hvdWxkQ2xvc2VPbkVzY2FwZVByZXNzOiB0cnVlLFxuICAgIHBvc2l0aW9uOiBQb3NpdGlvbi5SSUdIVFxuICB9XG5cbiAgcmVuZGVyKCkge1xuICAgIGNvbnN0IHtcbiAgICAgIHdpZHRoLFxuICAgICAgaXNTaG93bixcbiAgICAgIGNoaWxkcmVuLFxuICAgICAgY29udGFpbmVyUHJvcHMsXG4gICAgICBvbk9wZW5Db21wbGV0ZSxcbiAgICAgIG9uQ2xvc2VDb21wbGV0ZSxcbiAgICAgIHNob3VsZENsb3NlT25PdmVybGF5Q2xpY2ssXG4gICAgICBzaG91bGRDbG9zZU9uRXNjYXBlUHJlc3MsXG4gICAgICBwb3NpdGlvblxuICAgIH0gPSB0aGlzLnByb3BzXG5cbiAgICByZXR1cm4gKFxuICAgICAgPE92ZXJsYXlcbiAgICAgICAgaXNTaG93bj17aXNTaG93bn1cbiAgICAgICAgc2hvdWxkQ2xvc2VPbkNsaWNrPXtzaG91bGRDbG9zZU9uT3ZlcmxheUNsaWNrfVxuICAgICAgICBzaG91bGRDbG9zZU9uRXNjYXBlUHJlc3M9e3Nob3VsZENsb3NlT25Fc2NhcGVQcmVzc31cbiAgICAgICAgb25FeGl0ZWQ9e29uQ2xvc2VDb21wbGV0ZX1cbiAgICAgICAgb25FbnRlcmVkPXtvbk9wZW5Db21wbGV0ZX1cbiAgICAgID5cbiAgICAgICAgeyh7IHN0YXRlLCBjbG9zZSB9KSA9PiAoXG4gICAgICAgICAgPFBhbmVcbiAgICAgICAgICAgIHdpZHRoPXt3aWR0aH1cbiAgICAgICAgICAgIHsuLi5wYW5lUHJvcHNbcG9zaXRpb25dfVxuICAgICAgICAgICAgY3NzPXthbmltYXRpb25TdHlsZXNbcG9zaXRpb25dfVxuICAgICAgICAgICAgZGF0YS1zdGF0ZT17c3RhdGV9XG4gICAgICAgICAgPlxuICAgICAgICAgICAgPFNoZWV0Q2xvc2VcbiAgICAgICAgICAgICAgcG9zaXRpb249e3Bvc2l0aW9ufVxuICAgICAgICAgICAgICBkYXRhLXN0YXRlPXtzdGF0ZX1cbiAgICAgICAgICAgICAgaXNDbG9zaW5nPXtmYWxzZX1cbiAgICAgICAgICAgICAgb25DbGljaz17Y2xvc2V9XG4gICAgICAgICAgICAvPlxuICAgICAgICAgICAgPFBhbmVcbiAgICAgICAgICAgICAgZWxldmF0aW9uPXs0fVxuICAgICAgICAgICAgICBiYWNrZ3JvdW5kQ29sb3I9XCJ3aGl0ZVwiXG4gICAgICAgICAgICAgIG92ZXJmbG93WT1cImF1dG9cIlxuICAgICAgICAgICAgICBtYXhIZWlnaHQ9XCIxMDB2aFwiXG4gICAgICAgICAgICAgIGRhdGEtc3RhdGU9e3N0YXRlfVxuICAgICAgICAgICAgICB3aWR0aD17d2lkdGh9XG4gICAgICAgICAgICAgIHsuLi5zdWJwYW5lUHJvcHNbcG9zaXRpb25dfVxuICAgICAgICAgICAgICB7Li4uY29udGFpbmVyUHJvcHN9XG4gICAgICAgICAgICA+XG4gICAgICAgICAgICAgIHt0eXBlb2YgY2hpbGRyZW4gPT09ICdmdW5jdGlvbicgPyBjaGlsZHJlbih7IGNsb3NlIH0pIDogY2hpbGRyZW59XG4gICAgICAgICAgICA8L1BhbmU+XG4gICAgICAgICAgPC9QYW5lPlxuICAgICAgICApfVxuICAgICAgPC9PdmVybGF5PlxuICAgIClcbiAgfVxufVxuXG5leHBvcnQgZGVmYXVsdCBTaWRlU2hlZXRcbiJdfQ==