import _extends from "@babel/runtime/helpers/esm/extends";
import _objectWithoutProperties from "@babel/runtime/helpers/esm/objectWithoutProperties";
import _objectSpread from "@babel/runtime/helpers/esm/objectSpread";
import _toConsumableArray from "@babel/runtime/helpers/esm/toConsumableArray";
import _classCallCheck from "@babel/runtime/helpers/esm/classCallCheck";
import _createClass from "@babel/runtime/helpers/esm/createClass";
import _possibleConstructorReturn from "@babel/runtime/helpers/esm/possibleConstructorReturn";
import _getPrototypeOf from "@babel/runtime/helpers/esm/getPrototypeOf";
import _inherits from "@babel/runtime/helpers/esm/inherits";
import _assertThisInitialized from "@babel/runtime/helpers/esm/assertThisInitialized";
import _defineProperty from "@babel/runtime/helpers/esm/defineProperty";
import React from 'react';
import { css } from 'glamor';
import PropTypes from 'prop-types';
import { StackingOrder } from '../../constants';
import Toast from './Toast';
var wrapperClass = css({
  maxWidth: 560,
  margin: '0 auto',
  top: 0,
  left: 0,
  right: 0,
  position: 'fixed',
  zIndex: StackingOrder.TOASTER,
  pointerEvents: 'none'
});

var ToastManager =
/*#__PURE__*/
function (_React$PureComponent) {
  _inherits(ToastManager, _React$PureComponent);

  function ToastManager(props, context) {
    var _this;

    _classCallCheck(this, ToastManager);

    _this = _possibleConstructorReturn(this, _getPrototypeOf(ToastManager).call(this, props, context));

    _defineProperty(_assertThisInitialized(_assertThisInitialized(_this)), "getToasts", function () {
      return _this.state.toasts;
    });

    _defineProperty(_assertThisInitialized(_assertThisInitialized(_this)), "closeAll", function () {
      _this.getToasts().forEach(function (toast) {
        return toast.close();
      });
    });

    _defineProperty(_assertThisInitialized(_assertThisInitialized(_this)), "notify", function (title, settings) {
      var instance = _this.createToastInstance(title, settings);

      _this.setState(function (previousState) {
        return {
          toasts: [instance].concat(_toConsumableArray(previousState.toasts))
        };
      });

      return instance;
    });

    _defineProperty(_assertThisInitialized(_assertThisInitialized(_this)), "createToastInstance", function (title, settings) {
      var id = ++ToastManager.idCounter;
      return {
        id: id,
        title: title,
        description: settings.description,
        hasCloseButton: settings.hasCloseButton || true,
        duration: settings.duration || 5,
        close: function close() {
          return _this.closeToast(id);
        },
        intent: settings.intent
      };
    });

    _defineProperty(_assertThisInitialized(_assertThisInitialized(_this)), "closeToast", function (id) {
      _this.setState(function (previousState) {
        return {
          toasts: previousState.toasts.map(function (toast) {
            if (toast.id === id) {
              return _objectSpread({}, toast, {
                isShown: false
              });
            }

            return toast;
          })
        };
      });
    });

    _defineProperty(_assertThisInitialized(_assertThisInitialized(_this)), "removeToast", function (id) {
      _this.setState(function (previousState) {
        return {
          toasts: previousState.toasts.filter(function (toast) {
            return toast.id !== id;
          })
        };
      });
    });

    props.bindNotify(_this.notify);
    props.bindGetToasts(_this.getToasts);
    props.bindCloseAll(_this.closeAll);
    _this.state = {
      toasts: []
    };
    return _this;
  }

  _createClass(ToastManager, [{
    key: "render",
    value: function render() {
      var _this2 = this;

      return React.createElement("span", {
        className: wrapperClass
      }, this.state.toasts.map(function (_ref) {
        var id = _ref.id,
            description = _ref.description,
            props = _objectWithoutProperties(_ref, ["id", "description"]);

        return React.createElement(Toast, _extends({
          key: id,
          onRemove: function onRemove() {
            return _this2.removeToast(id);
          }
        }, props), description);
      }));
    }
  }]);

  return ToastManager;
}(React.PureComponent);

ToastManager.displayName = "ToastManager";

_defineProperty(ToastManager, "propTypes", {
  /**
   * Function called with the `this.notify` function.
   */
  bindNotify: PropTypes.func.isRequired,

  /**
   * Function called with the `this.getToasts` function.
   */
  bindGetToasts: PropTypes.func.isRequired,

  /**
   * Function called with the `this.closeAll` function.
   */
  bindCloseAll: PropTypes.func.isRequired
});

_defineProperty(ToastManager, "idCounter", 0);

export { ToastManager as default };
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uLy4uL3NyYy90b2FzdGVyL3NyYy9Ub2FzdE1hbmFnZXIuanMiXSwibmFtZXMiOlsiUmVhY3QiLCJjc3MiLCJQcm9wVHlwZXMiLCJTdGFja2luZ09yZGVyIiwiVG9hc3QiLCJ3cmFwcGVyQ2xhc3MiLCJtYXhXaWR0aCIsIm1hcmdpbiIsInRvcCIsImxlZnQiLCJyaWdodCIsInBvc2l0aW9uIiwiekluZGV4IiwiVE9BU1RFUiIsInBvaW50ZXJFdmVudHMiLCJUb2FzdE1hbmFnZXIiLCJwcm9wcyIsImNvbnRleHQiLCJzdGF0ZSIsInRvYXN0cyIsImdldFRvYXN0cyIsImZvckVhY2giLCJ0b2FzdCIsImNsb3NlIiwidGl0bGUiLCJzZXR0aW5ncyIsImluc3RhbmNlIiwiY3JlYXRlVG9hc3RJbnN0YW5jZSIsInNldFN0YXRlIiwicHJldmlvdXNTdGF0ZSIsImlkIiwiaWRDb3VudGVyIiwiZGVzY3JpcHRpb24iLCJoYXNDbG9zZUJ1dHRvbiIsImR1cmF0aW9uIiwiY2xvc2VUb2FzdCIsImludGVudCIsIm1hcCIsImlzU2hvd24iLCJmaWx0ZXIiLCJiaW5kTm90aWZ5Iiwibm90aWZ5IiwiYmluZEdldFRvYXN0cyIsImJpbmRDbG9zZUFsbCIsImNsb3NlQWxsIiwicmVtb3ZlVG9hc3QiLCJQdXJlQ29tcG9uZW50IiwiZnVuYyIsImlzUmVxdWlyZWQiXSwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7O0FBQUEsT0FBT0EsS0FBUCxNQUFrQixPQUFsQjtBQUNBLFNBQVNDLEdBQVQsUUFBb0IsUUFBcEI7QUFDQSxPQUFPQyxTQUFQLE1BQXNCLFlBQXRCO0FBQ0EsU0FBU0MsYUFBVCxRQUE4QixpQkFBOUI7QUFDQSxPQUFPQyxLQUFQLE1BQWtCLFNBQWxCO0FBRUEsSUFBTUMsWUFBWSxHQUFHSixHQUFHLENBQUM7QUFDdkJLLEVBQUFBLFFBQVEsRUFBRSxHQURhO0FBRXZCQyxFQUFBQSxNQUFNLEVBQUUsUUFGZTtBQUd2QkMsRUFBQUEsR0FBRyxFQUFFLENBSGtCO0FB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TUFBS0MsUUFBeEI7QUFFQSxVQUFLMUIsS0FBTCxHQUFhO0FBQ1hDLE1BQUFBLE1BQU0sRUFBRTtBQURHLEtBQWI7QUFQMEI7QUFVM0I7Ozs7NkJBZ0VRO0FBQUE7O0FBQ1AsYUFDRTtBQUFNLFFBQUEsU0FBUyxFQUFFZDtBQUFqQixTQUNHLEtBQUthLEtBQUwsQ0FBV0MsTUFBWCxDQUFrQmtCLEdBQWxCLENBQXNCLGdCQUFtQztBQUFBLFlBQWhDUCxFQUFnQyxRQUFoQ0EsRUFBZ0M7QUFBQSxZQUE1QkUsV0FBNEIsUUFBNUJBLFdBQTRCO0FBQUEsWUFBWmhCLEtBQVk7O0FBQ3hELGVBQ0Usb0JBQUMsS0FBRDtBQUFPLFVBQUEsR0FBRyxFQUFFYyxFQUFaO0FBQWdCLFVBQUEsUUFBUSxFQUFFO0FBQUEsbUJBQU0sTUFBSSxDQUFDZSxXQUFMLENBQWlCZixFQUFqQixDQUFOO0FBQUE7QUFBMUIsV0FBMERkLEtBQTFELEdBQ0dnQixXQURILENBREY7QUFLRCxPQU5BLENBREgsQ0FERjtBQVdEOzs7O0VBMUd1Q2hDLEtBQUssQ0FBQzhDLGE7O0FBQTNCL0IsWTs7Z0JBQUFBLFksZUFDQTtBQUNqQjs7O0FBR0F5QixFQUFBQSxVQUFVLEVBQUV0QyxTQUFTLENBQUM2QyxJQUFWLENBQWVDLFVBSlY7O0FBTWpCOzs7QUFHQU4sRUFBQUEsYUFBYSxFQUFFeEMsU0FBUyxDQUFDNkMsSUFBVixDQUFlQyxVQVRiOztBQVdqQjs7O0FBR0FMLEVBQUFBLFlBQVksRUFBRXpDLFNBQVMsQ0FBQzZDLElBQVYsQ0FBZUM7QUFkWixDOztnQkFEQWpDLFksZUFrQkEsQzs7U0FsQkFBLFkiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgUmVhY3QgZnJvbSAncmVhY3QnXG5pbXBvcnQgeyBjc3MgfSBmcm9tICdnbGFtb3InXG5pbXBvcnQgUHJvcFR5cGVzIGZyb20gJ3Byb3AtdHlwZXMnXG5pbXBvcnQgeyBTdGFja2luZ09yZGVyIH0gZnJvbSAnLi4vLi4vY29uc3RhbnRzJ1xuaW1wb3J0IFRvYXN0IGZyb20gJy4vVG9hc3QnXG5cbmNvbnN0IHdyYXBwZXJDbGFzcyA9IGNzcyh7XG4gIG1heFdpZHRoOiA1NjAsXG4gIG1hcmdpbjogJzAgYXV0bycsXG4gIHRvcDogMCxcbiAgbGVmdDogMCxcbiAgcmlnaHQ6IDAsXG4gIHBvc2l0aW9uOiAnZml4ZWQnLFxuICB6SW5kZXg6IFN0YWNraW5nT3JkZXIuVE9BU1RFUixcbiAgcG9pbnRlckV2ZW50czogJ25vbmUnXG59KVxuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBUb2FzdE1hbmFnZXIgZXh0ZW5kcyBSZWFjdC5QdXJlQ29tcG9uZW50IHtcbiAgc3RhdGljIHByb3BUeXBlcyA9IHtcbiAgICAvKipcbiAgICAgKiBGdW5jdGlvbiBjYWxsZWQgd2l0aCB0aGUgYHRoaXMubm90aWZ5YCBmdW5jdGlvbi5cbiAgICAgKi9cbiAgICBiaW5kTm90aWZ5OiBQcm9wVHlwZXMuZnVuYy5pc1JlcXVpcmVkLFxuXG4gICAgLyoqXG4gICAgICogRnVuY3Rpb24gY2FsbGVkIHdpdGggdGhlIGB0aGlzLmdldFRvYXN0c2AgZnVuY3Rpb24uXG4gICAgICovXG4gICAgYmluZEdldFRvYXN0czogUHJvcFR5cGVzLmZ1bmMuaXNSZXF1aXJlZCxcblxuICAgIC8qKlxuICAgICAqIEZ1bmN0aW9uIGNhbGxlZCB3aXRoIHRoZSBgdGhpcy5jbG9zZUFsbGAgZnVuY3Rpb24uXG4gICAgICovXG4gICAgYmluZENsb3NlQWxsOiBQcm9wVHlwZXMuZnVuYy5pc1JlcXVpcmVkXG4gIH1cblxuICBzdGF0aWMgaWRDb3VudGVyID0gMFxuXG4gIGNvbnN0cnVjdG9yKHByb3BzLCBjb250ZXh0KSB7XG4gICAgc3VwZXIocHJvcHMsIGNvbnRleHQpXG5cbiAgICBwcm9wcy5iaW5kTm90aWZ5KHRoaXMubm90aWZ5KVxuICAgIHByb3BzLmJpbmRHZXRUb2FzdHModGhpcy5nZXRUb2FzdHMpXG4gICAgcHJvcHMuYmluZENsb3NlQWxsKHRoaXMuY2xvc2VBbGwpXG5cbiAgICB0aGlzLnN0YXRlID0ge1xuICAgICAgdG9hc3RzOiBbXVxuICAgIH1cbiAgfVxuXG4gIGdldFRvYXN0cyA9ICgpID0+IHtcbiAgICByZXR1cm4gdGhpcy5zdGF0ZS50b2FzdHNcbiAgfVxuXG4gIGNsb3NlQWxsID0gKCkgPT4ge1xuICAgIHRoaXMuZ2V0VG9hc3RzKCkuZm9yRWFjaCh0b2FzdCA9PiB0b2FzdC5jbG9zZSgpKVxuICB9XG5cbiAgbm90aWZ5ID0gKHRpdGxlLCBzZXR0aW5ncykgPT4ge1xuICAgIGNvbnN0IGluc3RhbmNlID0gdGhpcy5jcmVhdGVUb2FzdEluc3RhbmNlKHRpdGxlLCBzZXR0aW5ncylcblxuICAgIHRoaXMuc2V0U3RhdGUocHJldmlvdXNTdGF0ZSA9PiB7XG4gICAgICByZXR1cm4ge1xuICAgICAgICB0b2FzdHM6IFtpbnN0YW5jZSwgLi4ucHJldmlvdXNTdGF0ZS50b2FzdHNdXG4gICAgICB9XG4gICAgfSlcblxuICAgIHJldHVybiBpbnN0YW5jZVxuICB9XG5cbiAgY3JlYXRlVG9hc3RJbnN0YW5jZSA9ICh0aXRsZSwgc2V0dGluZ3MpID0+IHtcbiAgICBjb25zdCBpZCA9ICsrVG9hc3RNYW5hZ2VyLmlkQ291bnRlclxuXG4gICAgcmV0dXJuIHtcbiAgICAgIGlkLFxuICAgICAgdGl0bGUsXG4gICAgICBkZXNjcmlwdGlvbjogc2V0dGluZ3MuZGVzY3JpcHRpb24sXG4gICAgICBoYXNDbG9zZUJ1dHRvbjogc2V0dGluZ3MuaGFzQ2xvc2VCdXR0b24gfHwgdHJ1ZSxcbiAgICAgIGR1cmF0aW9uOiBzZXR0aW5ncy5kdXJhdGlvbiB8fCA1LFxuICAgICAgY2xvc2U6ICgpID0+IHRoaXMuY2xvc2VUb2FzdChpZCksXG4gICAgICBpbnRlbnQ6IHNldHRpbmdzLmludGVudFxuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBUaGlzIHdpbGwgc2V0IGlzU2hvd24gb24gdGhlIFRvYXN0IHdoaWNoIHdpbGwgY2xvc2UgdGhlIHRvYXN0LlxuICAgKiBJdCB3b24ndCByZW1vdmUgdGhlIHRvYXN0IHVudGlsIG9uRXhpdGVkIHRyaWdnZXJzIG9uUmVtb3ZlLlxuICAgKi9cbiAgY2xvc2VUb2FzdCA9IGlkID0+IHtcbiAgICB0aGlzLnNldFN0YXRlKHByZXZpb3VzU3RhdGUgPT4ge1xuICAgICAgcmV0dXJuIHtcbiAgICAgICAgdG9hc3RzOiBwcmV2aW91c1N0YXRlLnRvYXN0cy5tYXAodG9hc3QgPT4ge1xuICAgICAgICAgIGlmICh0b2FzdC5pZCA9PT0gaWQpIHtcbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgIC4uLnRvYXN0LFxuICAgICAgICAgICAgICBpc1Nob3duOiBmYWxzZVxuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgICByZXR1cm4gdG9hc3RcbiAgICAgICAgfSlcbiAgICAgIH1cbiAgICB9KVxuICB9XG5cbiAgcmVtb3ZlVG9hc3QgPSBpZCA9PiB7XG4gICAgdGhpcy5zZXRTdGF0ZShwcmV2aW91c1N0YXRlID0+IHtcbiAgICAgIHJldHVybiB7XG4gICAgICAgIHRvYXN0czogcHJldmlvdXNTdGF0ZS50b2FzdHMuZmlsdGVyKHRvYXN0ID0+IHRvYXN0LmlkICE9PSBpZClcbiAgICAgIH1cbiAgICB9KVxuICB9XG5cbiAgcmVuZGVyKCkge1xuICAgIHJldHVybiAoXG4gICAgICA8c3BhbiBjbGFzc05hbWU9e3dyYXBwZXJDbGFzc30+XG4gICAgICAgIHt0aGlzLnN0YXRlLnRvYXN0cy5tYXAoKHsgaWQsIGRlc2NyaXB0aW9uLCAuLi5wcm9wcyB9KSA9PiB7XG4gICAgICAgICAgcmV0dXJuIChcbiAgICAgICAgICAgIDxUb2FzdCBrZXk9e2lkfSBvblJlbW92ZT17KCkgPT4gdGhpcy5yZW1vdmVUb2FzdChpZCl9IHsuLi5wcm9wc30+XG4gICAgICAgICAgICAgIHtkZXNjcmlwdGlvbn1cbiAgICAgICAgICAgIDwvVG9hc3Q+XG4gICAgICAgICAgKVxuICAgICAgICB9KX1cbiAgICAgIDwvc3Bhbj5cbiAgICApXG4gIH1cbn1cbiJdfQ==