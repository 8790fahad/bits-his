import _extends from "@babel/runtime/helpers/esm/extends";
import _classCallCheck from "@babel/runtime/helpers/esm/classCallCheck";
import _createClass from "@babel/runtime/helpers/esm/createClass";
import _possibleConstructorReturn from "@babel/runtime/helpers/esm/possibleConstructorReturn";
import _getPrototypeOf from "@babel/runtime/helpers/esm/getPrototypeOf";
import _inherits from "@babel/runtime/helpers/esm/inherits";
import _objectSpread from "@babel/runtime/helpers/esm/objectSpread";
import _defineProperty from "@babel/runtime/helpers/esm/defineProperty";

var _paneProps, _subpaneProps, _animationStyles;

import React from 'react';
import PropTypes from 'prop-types';
import { css } from 'ui-box';
import { Pane } from '../../layers';
import { Overlay } from '../../overlay';
import { Position } from '../../constants';
import SheetClose from './SheetClose';
var paneProps = (_paneProps = {}, _defineProperty(_paneProps, Position.LEFT, {
  height: '100vh',
  maxWidth: '100vw',
  position: 'absolute',
  left: 0,
  right: 'auto'
}), _defineProperty(_paneProps, Position.RIGHT, {
  height: '100vh',
  maxWidth: '100vw',
  position: 'absolute',
  right: 0,
  left: 'auto'
}), _defineProperty(_paneProps, Position.TOP, {
  width: '100vw',
  position: 'absolute',
  maxHeight: '100vh',
  top: 0,
  bottom: 'auto'
}), _defineProperty(_paneProps, Position.BOTTOM, {
  width: '100vw',
  maxHeight: '100vh',
  position: 'absolute',
  bottom: 0,
  top: 'auto'
}), _paneProps);
var subpaneProps = (_subpaneProps = {}, _defineProperty(_subpaneProps, Position.LEFT, {
  height: '100vh'
}), _defineProperty(_subpaneProps, Position.RIGHT, {
  height: '100vh'
}), _defineProperty(_subpaneProps, Position.TOP, {
  width: '100vw'
}), _defineProperty(_subpaneProps, Position.BOTTOM, {
  width: '100vw'
}), _subpaneProps);
var animationEasing = {
  deceleration: "cubic-bezier(0.0, 0.0, 0.2, 1)",
  acceleration: "cubic-bezier(0.4, 0.0, 1, 1)"
};
var ANIMATION_DURATION = 240;

var withAnimations = function withAnimations(animateIn, animateOut) {
  return {
    '&[data-state="entering"], &[data-state="entered"]': {
      animation: "".concat(animateIn, " ").concat(ANIMATION_DURATION, "ms ").concat(animationEasing.deceleration, " both")
    },
    '&[data-state="exiting"]': {
      animation: "".concat(animateOut, " ").concat(ANIMATION_DURATION, "ms ").concat(animationEasing.acceleration, " both")
    }
  };
};

var animationStyles = (_animationStyles = {}, _defineProperty(_animationStyles, Position.LEFT, _objectSpread({
  transform: "translateX(-100%)"
}, withAnimations(css.keyframes('anchoredLeftSlideInAnimation', {
  from: {
    transform: "translateX(-100%)"
  },
  to: {
    transform: "translateX(0)"
  }
}), css.keyframes('anchoredLeftSlideOutAnimation', {
  from: {
    transform: "translateX(0)"
  },
  to: {
    transform: "translateX(-100%)"
  }
})))), _defineProperty(_animationStyles, Position.RIGHT, _objectSpread({
  transform: "translateX(100%)"
}, withAnimations(css.keyframes('anchoredRightSlideInAnimation', {
  from: {
    transform: "translateX(100%)"
  },
  to: {
    transform: "translateX(0)"
  }
}), css.keyframes('anchoredRightSlideOutAnimation', {
  from: {
    transform: "translateX(0)"
  },
  to: {
    transform: "translateX(100%)"
  }
})))), _defineProperty(_animationStyles, Position.TOP, _objectSpread({
  transform: "translateY(-100%)"
}, withAnimations(css.keyframes('anchoredTopSlideInAnimation', {
  from: {
    transform: "translateY(-100%)"
  },
  to: {
    transform: "translateY(0)"
  }
}), css.keyframes('anchoredTopSlideOutAnimation', {
  from: {
    transform: "translateY(0)"
  },
  to: {
    transform: "translateY(-100%)"
  }
})))), _defineProperty(_animationStyles, Position.BOTTOM, _objectSpread({
  transform: "translateY(100%)"
}, withAnimations(css.keyframes('anchoredBottomSlideInAnimation', {
  from: {
    transform: "translateY(100%)"
  },
  to: {
    transform: "translateY(0)"
  }
}), css.keyframes('anchoredBottomSlideOutAnimation', {
  from: {
    transform: "translateY(0)"
  },
  to: {
    transform: "translateY(100%)"
  }
})))), _animationStyles);

var SideSheet =
/*#__PURE__*/
function (_React$Component) {
  _inherits(SideSheet, _React$Component);

  function SideSheet() {
    _classCallCheck(this, SideSheet);

    return _possibleConstructorReturn(this, _getPrototypeOf(SideSheet).apply(this, arguments));
  }

  _createClass(SideSheet, [{
    key: "render",
    value: function render() {
      var _this$props = this.props,
          width = _this$props.width,
          isShown = _this$props.isShown,
          children = _this$props.children,
          containerProps = _this$props.containerProps,
          onOpenComplete = _this$props.onOpenComplete,
          onCloseComplete = _this$props.onCloseComplete,
          shouldCloseOnOverlayClick = _this$props.shouldCloseOnOverlayClick,
          shouldCloseOnEscapePress = _this$props.shouldCloseOnEscapePress,
          position = _this$props.position;
      return React.createElement(Overlay, {
        isShown: isShown,
        shouldCloseOnClick: shouldCloseOnOverlayClick,
        shouldCloseOnEscapePress: shouldCloseOnEscapePress,
        onExited: onCloseComplete,
        onEntered: onOpenComplete
      }, function (_ref) {
        var state = _ref.state,
            close = _ref.close;
        return React.createElement(Pane, _extends({
          width: width
        }, paneProps[position], {
          css: animationStyles[position],
          "data-state": state
        }), React.createElement(SheetClose, {
          position: position,
          "data-state": state,
          isClosing: false,
          onClick: close
        }), React.createElement(Pane, _extends({
          elevation: 4,
          backgroundColor: "white",
          overflowY: "auto",
          maxHeight: "100vh",
          "data-state": state,
          width: width
        }, subpaneProps[position], containerProps), typeof children === 'function' ? children({
          close: close
        }) : children));
      });
    }
  }]);

  return SideSheet;
}(React.Component);

SideSheet.displayName = "SideSheet";

_defineProperty(SideSheet, "propTypes", {
  /**
   * Children can be a string, node or a function accepting `({ close })`.
   */
  children: PropTypes.oneOfType([PropTypes.node, PropTypes.func]).isRequired,

  /**
   * When true, the Side Sheet is shown.
   */
  isShown: PropTypes.bool,

  /**
   * Function that will be called when the exit transition is complete.
   */
  onCloseComplete: PropTypes.func,

  /**
   * Function that will be called when the enter transition is complete.
   */
  onOpenComplete: PropTypes.func,

  /**
   * Boolean indicating if clicking the overlay should close the overlay.
   */
  shouldCloseOnOverlayClick: PropTypes.bool,

  /**
   * Boolean indicating if pressing the esc key should close the overlay.
   */
  shouldCloseOnEscapePress: PropTypes.bool,

  /**
   * Width of the SideSheet.
   */
  width: PropTypes.oneOfType([PropTypes.string, PropTypes.number]).isRequired,

  /**
   * Properties to pass through the SideSheet container Pane.
   */
  containerProps: PropTypes.object,

  /**
   * Positions the sheet to the top, left, right, or bottom of the screen.
   */
  position: PropTypes.oneOf([Position.TOP, Position.BOTTOM, Position.LEFT, Position.RIGHT]).isRequired
});

_defineProperty(SideSheet, "defaultProps", {
  width: 620,
  onCloseComplete: function onCloseComplete() {},
  onOpenComplete: function onOpenComplete() {},
  shouldCloseOnOverlayClick: true,
  shouldCloseOnEscapePress: true,
  position: Position.RIGHT
});

export default SideSheet;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uLy4uL3NyYy9zaWRlLXNoZWV0L3NyYy9TaWRlU2hlZXQuanMiXSwibmFtZXMiOlsiUmVhY3QiLCJQcm9wVHlwZXMiLCJjc3MiLCJQYW5lIiwiT3ZlcmxheSIsIlBvc2l0aW9uIiwiU2hlZXRDbG9zZSIsInBhbmVQcm9wcyIsIkxFRlQiLCJoZWlnaHQiLCJtYXhXaWR0aCIsInBvc2l0aW9uIiwibGVmdCIsInJpZ2h0IiwiUklHSFQiLCJUT1AiLCJ3aWR0aCIsIm1heEhlaWdodCIsInRvcCIsImJvdHRvbSIsIkJPVFRPTSIsInN1YnBhbmVQcm9wcyIsImFuaW1hdGlvbkVhc2luZyIsImRlY2VsZXJhdGlvbiIsImFjY2VsZXJhdGlvbiIsIkFOSU1BVElPTl9EVVJBVElPTiIsIndpdGhBbmltYXRpb25zIiwiYW5pbWF0ZUluIiwiYW5pbWF0ZU91dCIsImFuaW1hdGlvbiIsImFuaW1hdGlvblN0eWxlcyIsInRyYW5zZm9ybSIsImtleWZyYW1lcyIsImZyb20iLCJ0byIsIlNpZGVTaGVldCIsInByb3BzIiwiaXNTaG93biIsImNoaWxkcmVuIiwiY29udGFpbmVyUHJvcHMiLCJvbk9wZW5Db21wbGV0ZSIsIm9uQ2xvc2VDb21wbGV0ZSIsInNob3VsZENsb3NlT25PdmVybGF5Q2xpY2siLCJzaG91bGRDbG9zZU9uRXNjYXBlUHJlc3MiLCJzdGF0ZSIsImNsb3NlIiwiQ29tcG9uZW50Iiwib25lT2ZUeXBlIiwibm9kZSIsImZ1bmMiLCJpc1JlcXVpcmVkIiwiYm9vbCIsInN0cmluZyIsIm51bWJlciIsIm9iamVjdCIsIm9uZU9mIl0sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7OztBQUFBLE9BQU9BLEtBQVAsTUFBa0IsT0FBbEI7QUFDQSxPQUFPQyxTQUFQLE1BQXNCLFlBQXRCO0FBQ0EsU0FBU0MsR0FBVCxRQUFvQixRQUFwQjtBQUNBLFNBQVNDLElBQVQsUUFBcUIsY0FBckI7QUFDQSxTQUFTQyxPQUFULFFBQXdCLGVBQXhCO0FBQ0EsU0FBU0MsUUFBVCxRQUF5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QUFWLENBQW9CLENBQUM5QyxTQUFTLENBQUNtRCxNQUFYLEVBQW1CbkQsU0FBUyxDQUFDb0QsTUFBN0IsQ0FBcEIsRUFBMERILFVBbENoRDs7QUFvQ2pCOzs7QUFHQVgsRUFBQUEsY0FBYyxFQUFFdEMsU0FBUyxDQUFDcUQsTUF2Q1Q7O0FBeUNqQjs7O0FBR0EzQyxFQUFBQSxRQUFRLEVBQUVWLFNBQVMsQ0FBQ3NELEtBQVYsQ0FBZ0IsQ0FDeEJsRCxRQUFRLENBQUNVLEdBRGUsRUFFeEJWLFFBQVEsQ0FBQ2UsTUFGZSxFQUd4QmYsUUFBUSxDQUFDRyxJQUhlLEVBSXhCSCxRQUFRLENBQUNTLEtBSmUsQ0FBaEIsRUFLUG9DO0FBakRjLEM7O2dCQURmZixTLGtCQXFEa0I7QUFDcEJuQixFQUFBQSxLQUFLLEVBQUUsR0FEYTtBQUVwQnlCLEVBQUFBLGVBQWUsRUFBRSwyQkFBTSxDQUFFLENBRkw7QUFHcEJELEVBQUFBLGNBQWMsRUFBRSwwQkFBTSxDQUFFLENBSEo7QUFJcEJFLEVBQUFBLHlCQUF5QixFQUFFLElBSlA7QUFLcEJDLEVBQUFBLHdCQUF3QixFQUFFLElBTE47QUFNcEJoQyxFQUFBQSxRQUFRLEVBQUVOLFFBQVEsQ0FBQ1M7QUFOQyxDOztBQThEeEIsZUFBZXFCLFNBQWYiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgUmVhY3QgZnJvbSAncmVhY3QnXG5pbXBvcnQgUHJvcFR5cGVzIGZyb20gJ3Byb3AtdHlwZXMnXG5pbXBvcnQgeyBjc3MgfSBmcm9tICd1aS1ib3gnXG5pbXBvcnQgeyBQYW5lIH0gZnJvbSAnLi4vLi4vbGF5ZXJzJ1xuaW1wb3J0IHsgT3ZlcmxheSB9IGZyb20gJy4uLy4uL292ZXJsYXknXG5pbXBvcnQgeyBQb3NpdGlvbiB9IGZyb20gJy4uLy4uL2NvbnN0YW50cydcbmltcG9ydCBTaGVldENsb3NlIGZyb20gJy4vU2hlZXRDbG9zZSdcblxuY29uc3QgcGFuZVByb3BzID0ge1xuICBbUG9zaXRpb24uTEVGVF06IHtcbiAgICBoZWlnaHQ6ICcxMDB2aCcsXG4gICAgbWF4V2lkdGg6ICcxMDB2dycsXG4gICAgcG9zaXRpb246ICdhYnNvbHV0ZScsXG4gICAgbGVmdDogMCxcbiAgICByaWdodDogJ2F1dG8nXG4gIH0sXG4gIFtQb3NpdGlvbi5SSUdIVF06IHtcbiAgICBoZWlnaHQ6ICcxMDB2aCcsXG4gICAgbWF4V2lkdGg6ICcxMDB2dycsXG4gICAgcG9zaXRpb246ICdhYnNvbHV0ZScsXG4gICAgcmlnaHQ6IDAsXG4gICAgbGVmdDogJ2F1dG8nXG4gIH0sXG4gIFtQb3NpdGlvbi5UT1BdOiB7XG4gICAgd2lkdGg6ICcxMDB2dycsXG4gICAgcG9zaXRpb246ICdhYnNvbHV0ZScsXG4gICAgbWF4SGVpZ2h0OiAnMTAwdmgnLFxuICAgIHRvcDogMCxcbiAgICBib3R0b206ICdhdXRvJ1xuICB9LFxuICBbUG9zaXRpb24uQk9UVE9NXToge1xuICAgIHdpZHRoOiAnMTAwdncnLFxuICAgIG1heEhlaWdodDogJzEwMHZoJyxcbiAgICBwb3NpdGlvbjogJ2Fic29sdXRlJyxcbiAgICBib3R0b206IDAsXG4gICAgdG9wOiAnYXV0bydcbiAgfVxufVxuXG5jb25zdCBzdWJwYW5lUHJvcHMgPSB7XG4gIFtQb3NpdGlvbi5MRUZUXToge1xuICAgIGhlaWdodDogJzEwMHZoJ1xuICB9LFxuICBbUG9zaXRpb24uUklHSFRdOiB7XG4gICAgaGVpZ2h0OiAnMTAwdmgnXG4gIH0sXG4gIFtQb3NpdGlvbi5UT1BdOiB7XG4gICAgd2lkdGg6ICcxMDB2dydcbiAgfSxcbiAgW1Bvc2l0aW9uLkJPVFRPTV06IHtcbiAgICB3aWR0aDogJzEwMHZ3J1xuICB9XG59XG5cbmNvbnN0IGFuaW1hdGlvbkVhc2luZyA9IHtcbiAgZGVjZWxlcmF0aW9uOiBgY3ViaWMtYmV6aWVyKDAuMCwgMC4wLCAwLjIsIDEpYCxcbiAgYWNjZWxlcmF0aW9uOiBgY3ViaWMtYmV6aWVyKDAuNCwgMC4wLCAxLCAxKWBcbn1cblxuY29uc3QgQU5JTUFUSU9OX0RVUkFUSU9OID0gMjQwXG5cbmNvbnN0IHdpdGhBbmltYXRpb25zID0gKGFuaW1hdGVJbiwgYW5pbWF0ZU91dCkgPT4ge1xuICByZXR1cm4ge1xuICAgICcmW2RhdGEtc3RhdGU9XCJlbnRlcmluZ1wiXSwgJltkYXRhLXN0YXRlPVwiZW50ZXJlZFwiXSc6IHtcbiAgICAgIGFuaW1hdGlvbjogYCR7YW5pbWF0ZUlufSAke0FOSU1BVElPTl9EVVJBVElPTn1tcyAke1xuICAgICAgICBhbmltYXRpb25FYXNpbmcuZGVjZWxlcmF0aW9uXG4gICAgICB9IGJvdGhgXG4gICAgfSxcbiAgICAnJltkYXRhLXN0YXRlPVwiZXhpdGluZ1wiXSc6IHtcbiAgICAgIGFuaW1hdGlvbjogYCR7YW5pbWF0ZU91dH0gJHtBTklNQVRJT05fRFVSQVRJT059bXMgJHtcbiAgICAgICAgYW5pbWF0aW9uRWFzaW5nLmFjY2VsZXJhdGlvblxuICAgICAgfSBib3RoYFxuICAgIH1cbiAgfVxufVxuXG5jb25zdCBhbmltYXRpb25TdHlsZXMgPSB7XG4gIFtQb3NpdGlvbi5MRUZUXToge1xuICAgIHRyYW5zZm9ybTogYHRyYW5zbGF0ZVgoLTEwMCUpYCxcbiAgICAuLi53aXRoQW5pbWF0aW9ucyhcbiAgICAgIGNzcy5rZXlmcmFtZXMoJ2FuY2hvcmVkTGVmdFNsaWRlSW5BbmltYXRpb24nLCB7XG4gICAgICAgIGZyb206IHsgdHJhbnNmb3JtOiBgdHJhbnNsYXRlWCgtMTAwJSlgIH0sXG4gICAgICAgIHRvOiB7IHRyYW5zZm9ybTogYHRyYW5zbGF0ZVgoMClgIH1cbiAgICAgIH0pLFxuICAgICAgY3NzLmtleWZyYW1lcygnYW5jaG9yZWRMZWZ0U2xpZGVPdXRBbmltYXRpb24nLCB7XG4gICAgICAgIGZyb206IHsgdHJhbnNmb3JtOiBgdHJhbnNsYXRlWCgwKWAgfSxcbiAgICAgICAgdG86IHsgdHJhbnNmb3JtOiBgdHJhbnNsYXRlWCgtMTAwJSlgIH1cbiAgICAgIH0pXG4gICAgKVxuICB9LFxuICBbUG9zaXRpb24uUklHSFRdOiB7XG4gICAgdHJhbnNmb3JtOiBgdHJhbnNsYXRlWCgxMDAlKWAsXG4gICAgLi4ud2l0aEFuaW1hdGlvbnMoXG4gICAgICBjc3Mua2V5ZnJhbWVzKCdhbmNob3JlZFJpZ2h0U2xpZGVJbkFuaW1hdGlvbicsIHtcbiAgICAgICAgZnJvbTogeyB0cmFuc2Zvcm06IGB0cmFuc2xhdGVYKDEwMCUpYCB9LFxuICAgICAgICB0bzogeyB0cmFuc2Zvcm06IGB0cmFuc2xhdGVYKDApYCB9XG4gICAgICB9KSxcbiAgICAgIGNzcy5rZXlmcmFtZXMoJ2FuY2hvcmVkUmlnaHRTbGlkZU91dEFuaW1hdGlvbicsIHtcbiAgICAgICAgZnJvbTogeyB0cmFuc2Zvcm06IGB0cmFuc2xhdGVYKDApYCB9LFxuICAgICAgICB0bzogeyB0cmFuc2Zvcm06IGB0cmFuc2xhdGVYKDEwMCUpYCB9XG4gICAgICB9KVxuICAgIClcbiAgfSxcbiAgW1Bvc2l0aW9uLlRPUF06IHtcbiAgICB0cmFuc2Zvcm06IGB0cmFuc2xhdGVZKC0xMDAlKWAsXG4gICAgLi4ud2l0aEFuaW1hdGlvbnMoXG4gICAgICBjc3Mua2V5ZnJhbWVzKCdhbmNob3JlZFRvcFNsaWRlSW5BbmltYXRpb24nLCB7XG4gICAgICAgIGZyb206IHsgdHJhbnNmb3JtOiBgdHJhbnNsYXRlWSgtMTAwJSlgIH0sXG4gICAgICAgIHRvOiB7IHRyYW5zZm9ybTogYHRyYW5zbGF0ZVkoMClgIH1cbiAgICAgIH0pLFxuICAgICAgY3NzLmtleWZyYW1lcygnYW5jaG9yZWRUb3BTbGlkZU91dEFuaW1hdGlvbicsIHtcbiAgICAgICAgZnJvbTogeyB0cmFuc2Zvcm06IGB0cmFuc2xhdGVZKDApYCB9LFxuICAgICAgICB0bzogeyB0cmFuc2Zvcm06IGB0cmFuc2xhdGVZKC0xMDAlKWAgfVxuICAgICAgfSlcbiAgICApXG4gIH0sXG4gIFtQb3NpdGlvbi5CT1RUT01dOiB7XG4gICAgdHJhbnNmb3JtOiBgdHJhbnNsYXRlWSgxMDAlKWAsXG4gICAgLi4ud2l0aEFuaW1hdGlvbnMoXG4gICAgICBjc3Mua2V5ZnJhbWVzKCdhbmNob3JlZEJvdHRvbVNsaWRlSW5BbmltYXRpb24nLCB7XG4gICAgICAgIGZyb206IHsgdHJhbnNmb3JtOiBgdHJhbnNsYXRlWSgxMDAlKWAgfSxcbiAgICAgICAgdG86IHsgdHJhbnNmb3JtOiBgdHJhbnNsYXRlWSgwKWAgfVxuICAgICAgfSksXG4gICAgICBjc3Mua2V5ZnJhbWVzKCdhbmNob3JlZEJvdHRvbVNsaWRlT3V0QW5pbWF0aW9uJywge1xuICAgICAgICBmcm9tOiB7IHRyYW5zZm9ybTogYHRyYW5zbGF0ZVkoMClgIH0sXG4gICAgICAgIHRvOiB7IHRyYW5zZm9ybTogYHRyYW5zbGF0ZVkoMTAwJSlgIH1cbiAgICAgIH0pXG4gICAgKVxuICB9XG59XG5cbmNsYXNzIFNpZGVTaGVldCBleHRlbmRzIFJlYWN0LkNvbXBvbmVudCB7XG4gIHN0YXRpYyBwcm9wVHlwZXMgPSB7XG4gICAgLyoqXG4gICAgICogQ2hpbGRyZW4gY2FuIGJlIGEgc3RyaW5nLCBub2RlIG9yIGEgZnVuY3Rpb24gYWNjZXB0aW5nIGAoeyBjbG9zZSB9KWAuXG4gICAgICovXG4gICAgY2hpbGRyZW46IFByb3BUeXBlcy5vbmVPZlR5cGUoW1Byb3BUeXBlcy5ub2RlLCBQcm9wVHlwZXMuZnVuY10pLmlzUmVxdWlyZWQsXG5cbiAgICAvKipcbiAgICAgKiBXaGVuIHRydWUsIHRoZSBTaWRlIFNoZWV0IGlzIHNob3duLlxuICAgICAqL1xuICAgIGlzU2hvd246IFByb3BUeXBlcy5ib29sLFxuXG4gICAgLyoqXG4gICAgICogRnVuY3Rpb24gdGhhdCB3aWxsIGJlIGNhbGxlZCB3aGVuIHRoZSBleGl0IHRyYW5zaXRpb24gaXMgY29tcGxldGUuXG4gICAgICovXG4gICAgb25DbG9zZUNvbXBsZXRlOiBQcm9wVHlwZXMuZnVuYyxcblxuICAgIC8qKlxuICAgICAqIEZ1bmN0aW9uIHRoYXQgd2lsbCBiZSBjYWxsZWQgd2hlbiB0aGUgZW50ZXIgdHJhbnNpdGlvbiBpcyBjb21wbGV0ZS5cbiAgICAgKi9cbiAgICBvbk9wZW5Db21wbGV0ZTogUHJvcFR5cGVzLmZ1bmMsXG5cbiAgICAvKipcbiAgICAgKiBCb29sZWFuIGluZGljYXRpbmcgaWYgY2xpY2tpbmcgdGhlIG92ZXJsYXkgc2hvdWxkIGNsb3NlIHRoZSBvdmVybGF5LlxuICAgICAqL1xuICAgIHNob3VsZENsb3NlT25PdmVybGF5Q2xpY2s6IFByb3BUeXBlcy5ib29sLFxuXG4gICAgLyoqXG4gICAgICogQm9vbGVhbiBpbmRpY2F0aW5nIGlmIHByZXNzaW5nIHRoZSBlc2Mga2V5IHNob3VsZCBjbG9zZSB0aGUgb3ZlcmxheS5cbiAgICAgKi9cbiAgICBzaG91bGRDbG9zZU9uRXNjYXBlUHJlc3M6IFByb3BUeXBlcy5ib29sLFxuXG4gICAgLyoqXG4gICAgICogV2lkdGggb2YgdGhlIFNpZGVTaGVldC5cbiAgICAgKi9cbiAgICB3aWR0aDogUHJvcFR5cGVzLm9uZU9mVHlwZShbUHJvcFR5cGVzLnN0cmluZywgUHJvcFR5cGVzLm51bWJlcl0pLmlzUmVxdWlyZWQsXG5cbiAgICAvKipcbiAgICAgKiBQcm9wZXJ0aWVzIHRvIHBhc3MgdGhyb3VnaCB0aGUgU2lkZVNoZWV0IGNvbnRhaW5lciBQYW5lLlxuICAgICAqL1xuICAgIGNvbnRhaW5lclByb3BzOiBQcm9wVHlwZXMub2JqZWN0LFxuXG4gICAgLyoqXG4gICAgICogUG9zaXRpb25zIHRoZSBzaGVldCB0byB0aGUgdG9wLCBsZWZ0LCByaWdodCwgb3IgYm90dG9tIG9mIHRoZSBzY3JlZW4uXG4gICAgICovXG4gICAgcG9zaXRpb246IFByb3BUeXBlcy5vbmVPZihbXG4gICAgICBQb3NpdGlvbi5UT1AsXG4gICAgICBQb3NpdGlvbi5CT1RUT00sXG4gICAgICBQb3NpdGlvbi5MRUZULFxuICAgICAgUG9zaXRpb24uUklHSFRcbiAgICBdKS5pc1JlcXVpcmVkXG4gIH1cblxuICBzdGF0aWMgZGVmYXVsdFByb3BzID0ge1xuICAgIHdpZHRoOiA2MjAsXG4gICAgb25DbG9zZUNvbXBsZXRlOiAoKSA9PiB7fSxcbiAgICBvbk9wZW5Db21wbGV0ZTogKCkgPT4ge30sXG4gICAgc2hvdWxkQ2xvc2VPbk92ZXJsYXlDbGljazogdHJ1ZSxcbiAgICBzaG91bGRDbG9zZU9uRXNjYXBlUHJlc3M6IHRydWUsXG4gICAgcG9zaXRpb246IFBvc2l0aW9uLlJJR0hUXG4gIH1cblxuICByZW5kZXIoKSB7XG4gICAgY29uc3Qge1xuICAgICAgd2lkdGgsXG4gICAgICBpc1Nob3duLFxuICAgICAgY2hpbGRyZW4sXG4gICAgICBjb250YWluZXJQcm9wcyxcbiAgICAgIG9uT3BlbkNvbXBsZXRlLFxuICAgICAgb25DbG9zZUNvbXBsZXRlLFxuICAgICAgc2hvdWxkQ2xvc2VPbk92ZXJsYXlDbGljayxcbiAgICAgIHNob3VsZENsb3NlT25Fc2NhcGVQcmVzcyxcbiAgICAgIHBvc2l0aW9uXG4gICAgfSA9IHRoaXMucHJvcHNcblxuICAgIHJldHVybiAoXG4gICAgICA8T3ZlcmxheVxuICAgICAgICBpc1Nob3duPXtpc1Nob3dufVxuICAgICAgICBzaG91bGRDbG9zZU9uQ2xpY2s9e3Nob3VsZENsb3NlT25PdmVybGF5Q2xpY2t9XG4gICAgICAgIHNob3VsZENsb3NlT25Fc2NhcGVQcmVzcz17c2hvdWxkQ2xvc2VPbkVzY2FwZVByZXNzfVxuICAgICAgICBvbkV4aXRlZD17b25DbG9zZUNvbXBsZXRlfVxuICAgICAgICBvbkVudGVyZWQ9e29uT3BlbkNvbXBsZXRlfVxuICAgICAgPlxuICAgICAgICB7KHsgc3RhdGUsIGNsb3NlIH0pID0+IChcbiAgICAgICAgICA8UGFuZVxuICAgICAgICAgICAgd2lkdGg9e3dpZHRofVxuICAgICAgICAgICAgey4uLnBhbmVQcm9wc1twb3NpdGlvbl19XG4gICAgICAgICAgICBjc3M9e2FuaW1hdGlvblN0eWxlc1twb3NpdGlvbl19XG4gICAgICAgICAgICBkYXRhLXN0YXRlPXtzdGF0ZX1cbiAgICAgICAgICA+XG4gICAgICAgICAgICA8U2hlZXRDbG9zZVxuICAgICAgICAgICAgICBwb3NpdGlvbj17cG9zaXRpb259XG4gICAgICAgICAgICAgIGRhdGEtc3RhdGU9e3N0YXRlfVxuICAgICAgICAgICAgICBpc0Nsb3Npbmc9e2ZhbHNlfVxuICAgICAgICAgICAgICBvbkNsaWNrPXtjbG9zZX1cbiAgICAgICAgICAgIC8+XG4gICAgICAgICAgICA8UGFuZVxuICAgICAgICAgICAgICBlbGV2YXRpb249ezR9XG4gICAgICAgICAgICAgIGJhY2tncm91bmRDb2xvcj1cIndoaXRlXCJcbiAgICAgICAgICAgICAgb3ZlcmZsb3dZPVwiYXV0b1wiXG4gICAgICAgICAgICAgIG1heEhlaWdodD1cIjEwMHZoXCJcbiAgICAgICAgICAgICAgZGF0YS1zdGF0ZT17c3RhdGV9XG4gICAgICAgICAgICAgIHdpZHRoPXt3aWR0aH1cbiAgICAgICAgICAgICAgey4uLnN1YnBhbmVQcm9wc1twb3NpdGlvbl19XG4gICAgICAgICAgICAgIHsuLi5jb250YWluZXJQcm9wc31cbiAgICAgICAgICAgID5cbiAgICAgICAgICAgICAge3R5cGVvZiBjaGlsZHJlbiA9PT0gJ2Z1bmN0aW9uJyA/IGNoaWxkcmVuKHsgY2xvc2UgfSkgOiBjaGlsZHJlbn1cbiAgICAgICAgICAgIDwvUGFuZT5cbiAgICAgICAgICA8L1BhbmU+XG4gICAgICAgICl9XG4gICAgICA8L092ZXJsYXk+XG4gICAgKVxuICB9XG59XG5cbmV4cG9ydCBkZWZhdWx0IFNpZGVTaGVldFxuIl19